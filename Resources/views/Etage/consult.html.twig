{# src/KE/MuseumBundle/Resources/views/Main/add.html.twig #}

{% extends "::base.html.twig" %}

{% block title %}
  Accueil - {{ parent() }}
{% endblock %}

{% block body %}
	<script src="//code.jquery.com/jquery-1.10.2.js"></script>
  <script src="//code.jquery.com/ui/1.11.2/jquery-ui.js"></script>
  <style>
  #sortable { list-style-type: none; margin: 0; padding: 0; width: 60%; }
  #sortable li { margin: 0 3px 3px 3px; padding: 0.4em; padding-left: 1.5em; font-size: 1.4em; height: 18px; }
  #sortable li span { position: absolute; margin-left: -1.3em; }
  </style>


        <h1>Liste des étages</h1>
        
        <div class="table-responsive">
			
			<h2>
				Etat : 
				{% if etage.placeDisponible == etage.longueur %}
					<font color="green"> Vide</font>
				{% elseif etage.placeDisponible > 0%}
					<font color="blue"> Disponible</font>
				{% else %}
					<font color="red"> Plein</font>
				{% endif %}
			</h2>
			<h3> Action :
				<a href="{{ path('etage_edit', {'code': etage.code}) }}" class="btn btn-default">
					<i class="glyphicon glyphicon-edit"></i>
				</a>
				{% if etage.placeDisponible == etage.longueur %}
					<a href="{{ path('etage_delete', {'code': etage.code}) }}" class="btn btn-default">
						<i class="glyphicon glyphicon-trash"></i>
					</a>	
				{% endif %}
			</h3>
			<h3>Caractéristiques de l'étage : </h3>
			<div class="well">
			<table class="table">
				<tbody>
					<tr>
						<td> <b>Code</b> </td>
						<td> {{etage.code}} </td>
					</tr>
					<tr>
						<td> <b>Armoire </b></td>
						<td> 
							{% for armoire in armoires %}								
								{% if armoire.id == etage.idArmoire %}
									{{ armoire.code }}
								{% endif %}								
							{% endfor %}
						</td>
					</tr>
					<tr>
						<td> <b>Longueur </b></td>
						<td> {{etage.longueur}} </td>
					</tr>
					<tr>
						<td> <b>Profondeur </b></td>
						<td> {{etage.profondeur}} </td>
					</tr>
					<tr>
						<td> <b>Hauteur </b></td>
						<td> {{etage.hauteur}} </td>
					</tr>
					<tr>
						<td> <b>Place disponible </b></td>
						<td> {{etage.placeDisponible}} </td>
					</tr>
				</tbody>
			</table>
			</div>
		</div>
		
		<div class="table-responsive">
			<h3>Liste des Objets liés : </h3>
			<div class="well">
			<table class="table" id="table-1">
				<thead>
					<tr>
						<th>Ordre</th>
						<th>Code objet</th>
						<th>Nom</th>
						<th>Longueur</th>	
						<th>Hauteur</th>	
						<th>Profondeur</th>	
						<th>Action</th>
					</tr>
				</thead>
				<tbody>
					{% for ordre in ordres %}
						{% for objet in objets %}
							{% if objet.id == ordre.idObjet %}
								<tr>
									<td>
										{% if ordre.ordre > 1 %}
										<a href="{{ path('etage_ordre_up', {'idEtage': etage.id, 'idObjet': objet.id}) }}" class="btn btn-default">
											<i class="glyphicon glyphicon-chevron-up"></i>
										</a>
										{% endif %}
										{% if ordre.ordre != ordres|length %}
										<a href="{{ path('etage_ordre_down', {'idEtage': etage.id, 'idObjet': objet.id}) }}" class="btn btn-default">
											<i class="glyphicon glyphicon-chevron-down"></i>
										</a>
										{% endif %}
									</td>
									<td>{{objet.code}}</td>
									<td>{{objet.nom}}</td>
									<td>{{objet.longueur}}</td>
									<td>{{objet.hauteur}}</td>
									<td>{{objet.profondeur}}</td>
									<td>
										<a href="{{ path('objet_consult', {'code': objet.code}) }}" class="btn btn-default">
											<i class="glyphicon glyphicon-eye-open"></i>
										</a>
										<a href="{{ path('etage_retirer_objet', {'codeEtage': etage.code, 'codeObjet': objet.code}) }}" class="btn btn-default">
											<i class="glyphicon glyphicon-remove"></i>
										</a>
									</td>
								</tr>
							{% endif %}
						{% endfor %}
					{% endfor %}
				</tbody>
			</table>
			</div>
		</div>
		{% set objetsPourcent = 0 %}
		<div class="table-responsive">
			<h3>Etage vue de face: </h3></br>
					<div id="objetsSurEtagere" style="height:100px;display:table;width:100%;">
					{% for ordre in ordres %}
						{% for objet in objets %}
							{% if objet.id == ordre.idObjet %}
								<div style="display:table-cell;
								border-width:2px;
								border-style:solid;
								width:{{ordre.pourcent}}%;
								{% set objetsPourcent = objetsPourcent + ordre.pourcent %}
								height:100%;
								background:#E8C782;
								vertical-align:middle;
								text-align:center;
								"><strong>{{objet.nom}}</strong></div>
							{% endif %}
						{% endfor %}
					{% endfor %}
					</div>
					<div id="plancherEtagere" style="float:right;width:100%;height:10px;background:#582900;"></div>
		</div>
		<script>
			var calculerHauteur = function() {
				console.log(jQuery(	'#plancherEtagere').width());
				jQuery(	'#objetsSurEtagere').height(jQuery(	'#plancherEtagere').width()/10	);
				jQuery(	'#objetsSurEtagere').width('{{objetsPourcent}}%');
				console.log(jQuery(	'#plancherEtagere').width());
				console.log(jQuery(	'#objetsSurEtagere').width());
				
			};
			
			$(window).on('resize',calculerHauteur);
			jQuery( document ).ready(calculerHauteur);
			
		</script>
    </body>
{% endblock %}